<html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title data-react-helmet="true">Android RoboSpice with GoogleHttpClient</title><meta data-react-helmet="true" property="description" content="In this post we will examine an example app in which we make a RoboSpice request
using GoogleHttpClient."/><meta data-react-helmet="true" property="og:title" content="Android RoboSpice with GoogleHttpClient"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:url" content="http://christopherbiscardi.com/2014/1/27/android-robospice-with-googlehttpclient/"/><meta data-react-helmet="true" property="og:description" content="In this post we will examine an example app in which we make a RoboSpice request
using GoogleHttpClient."/><meta data-react-helmet="true" property="og:image" content="http://christopherbiscardi.comnull"/><meta data-react-helmet="true" property="twitter:card" content="summary"/><meta data-react-helmet="true" property="twitter:title" content="Android RoboSpice with GoogleHttpClient"/><meta data-react-helmet="true" property="twitter:description" content="In this post we will examine an example app in which we make a RoboSpice request
using GoogleHttpClient."/><meta data-react-helmet="true" property="twitter:url" content="http://christopherbiscardi.com/2014/1/27/android-robospice-with-googlehttpclient/"/><link rel="stylesheet" type="text/css" href="/styles.f25bf9e6682280946ba2e441a544b407.css"/></head><body class="landing-page"><div id="content"><div data-reactroot="" data-reactid="1" data-react-checksum="242693943"><div class="Nav__wrapper___u7BUA" data-reactid="2"><nav class="Nav__nav___1e2Pp" data-reactid="3"><a class="Nav__logoWrapper___35yvY" href="/" data-reactid="4"><img class="Nav__logo___sw4O9" src="/69305db2985e926d498b513a21d28383.png" data-reactid="5"/></a><ul class="Nav__items___1oDCD" data-reactid="6"><li data-reactid="7"><a class="Nav__itemLink___H6Isv" href="/posts/" data-reactid="8">Posts</a></li><li data-reactid="9"><a href="https://github.com/ChristopherBiscardi/ama/issues?q=is%3Aissue+is%3Aclosed" class="Nav__itemLink___H6Isv" data-reactid="10">AMA</a></li><li data-reactid="11"><a class="Nav__itemLink___H6Isv" href="/books/" data-reactid="12">Books</a></li><li data-reactid="13"><a class="Nav__itemLink___H6Isv" href="/projects/" data-reactid="14">Projects</a></li><li data-reactid="15"><a class="Nav__itemLink___H6Isv" href="/about/" data-reactid="16">About</a></li></ul></nav></div><div data-reactid="17"><div class="Post__page___15ves" data-reactid="18"><!-- react-empty: 19 --><div class="Post__container___f_rKX" data-reactid="20"><div class="Post__singleColumn___tYK8R" data-reactid="21"><h1 class="Post__title___2I6DZ" data-reactid="22">Android RoboSpice with GoogleHttpClient</h1><div class="Post__meta___1fVoc" data-reactid="23"><!-- react-text: 24 -->Jan 27th, 2014<!-- /react-text --><!-- react-text: 25 --> · <!-- /react-text --><!-- react-text: 26 -->7<!-- /react-text --><!-- react-text: 27 --> minute read<!-- /react-text --></div></div></div><div class="Post__container___f_rKX" data-reactid="28"><div class="Post__singleColumn___tYK8R" data-reactid="29"><div data-reactid="30"><p>In this post we will examine an example app in which we make a RoboSpice request
using GoogleHttpClient.</p>
<p>The github repo is
<a href="https://github.com/ChristopherBiscardi/robospice-googlehttpclient-example">here</a>.</p>
<h2 id="dependencies">Dependencies</h2>
<p>First, we need to grab the RoboSpice dependency JARs from the <code>repository</code> repo.</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code>git <span class="highlight__hljs-built_in___3uuyR">clone</span> https://github.com/octo-online/robospice/tree/repository
</code></pre>
<p>Inside of
<a href="https://github.com/octo-online/robospice/tree/repository/dependencies/1.4.11/robospice-google-http-client">1.4.11/robospice-google-http-client</a>
are the JARs we need to include in the project. If you are using Eclipse copy
the JARs into your <code>libs/</code> folder and add them to the build path in <code>Project -&gt; Properties -&gt; Libraries</code> by clicking <code>Add JARs</code>. You may also need to click the
<code>Order and Export</code> tab, check their boxes and move the included JARs to the top.</p>
<p>We will also need one JAR from the Google-Http-Lib
<a href="https://code.google.com/p/google-http-java-client/wiki/Setup#Download_Library_with_Dependencies">source</a>.
It is <code>google-http-client-1.17.0</code>. Again, if using Eclipse, add it to your
project in the same way.</p>
<h2 id="classes">Classes</h2>
<p>We are going to create a few files:</p>
<ul>
<li><a href="#spice-base">BaseSpiceActivity.java</a></li>
<li><a href="#spice-reddit">Reddit*.java</a></li>
<li><a href="#spice-request-reddit">SpiceRequestReddit.java</a></li>
</ul>
<h4 id="basespiceactivity">BaseSpiceActivity</h4>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code><span class="highlight__hljs-keyword___som98">import</span> com.octo.android.robospice.JacksonGoogleHttpClientSpiceService;
<span class="highlight__hljs-keyword___som98">import</span> com.octo.android.robospice.SpiceManager;

<span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-class___mOeOV"><span class="highlight__hljs-keyword___som98">class</span> <span class="highlight__hljs-title___1fl8Q">BaseSpiceActivity</span> <span class="highlight__hljs-keyword___som98">extends</span> <span class="highlight__hljs-title___1fl8Q">Activity</span> </span>{
	<span class="highlight__hljs-keyword___som98">private</span> SpiceManager spiceManager = <span class="highlight__hljs-keyword___som98">new</span> SpiceManager(JacksonGoogleHttpClientSpiceService.class);

	<span class="hljs-meta">@Override</span>
	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">protected</span> <span class="highlight__hljs-keyword___som98">void</span> <span class="highlight__hljs-title___1fl8Q">onStart</span><span class="hljs-params">()</span> </span>{
		spiceManager.start(<span class="highlight__hljs-keyword___som98">this</span>);
		<span class="highlight__hljs-keyword___som98">super</span>.onStart();
	}

	<span class="hljs-meta">@Override</span>
	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">protected</span> <span class="highlight__hljs-keyword___som98">void</span> <span class="highlight__hljs-title___1fl8Q">onStop</span><span class="hljs-params">()</span> </span>{
		spiceManager.shouldStop();
		<span class="highlight__hljs-keyword___som98">super</span>.onStop();
	}

	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">protected</span> SpiceManager <span class="highlight__hljs-title___1fl8Q">getSpiceManager</span><span class="hljs-params">()</span> </span>{
		<span class="highlight__hljs-keyword___som98">return</span> spiceManager;
	}

}
</code></pre>
<p>The big thing we’re doing in this file is creating an instance of <code>SpiceManager</code>
that will be accessible in the activities that inherit from this base class
(like our <code>MainActivity.java</code> will).</p>
<p>We then start <code>spiceManager</code> in <code>onStart()</code> and stop it in <code>onStop</code>. This will
ensure that our activities have a <code>SpiceManager</code> accessible when they start and
clean up after themselves when they stop.</p>
<p>The final piece is a getter function (<code>getSpiceManager()</code>) so that we have easy
access to the <code>spiceManager</code> in our activities.</p>
<h4 id="redditjava">Reddit*.java</h4>
<p>We will be getting our data from Reddit, so we first need to examine the
responses we’re going to get. I’ve chosen a subreddit where all the posts are
very similar (/r/Riak). Here is a sample API response:</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code>{
   <span class="highlight__hljs-string___1SffY">"kind"</span>:<span class="highlight__hljs-string___1SffY">"Listing"</span>,
   <span class="highlight__hljs-string___1SffY">"data"</span>:{
      <span class="highlight__hljs-string___1SffY">"modhash"</span>:<span class="highlight__hljs-string___1SffY">"3mxugaulcd1f8b500be09"</span>,
      <span class="highlight__hljs-string___1SffY">"children"</span>:[
         {
            <span class="highlight__hljs-string___1SffY">"kind"</span>:<span class="highlight__hljs-string___1SffY">"t3"</span>,
            <span class="highlight__hljs-string___1SffY">"data"</span>:{
               <span class="highlight__hljs-string___1SffY">"domain"</span>:<span class="highlight__hljs-string___1SffY">"github.com"</span>,
               <span class="highlight__hljs-string___1SffY">"banned_by"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"media_embed"</span>:{

               },
               <span class="highlight__hljs-string___1SffY">"subreddit"</span>:<span class="highlight__hljs-string___1SffY">"Riak"</span>,
               <span class="highlight__hljs-string___1SffY">"selftext_html"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"selftext"</span>:<span class="highlight__hljs-string___1SffY">""</span>,
               <span class="highlight__hljs-string___1SffY">"likes"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"secure_media"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"link_flair_text"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"id"</span>:<span class="highlight__hljs-string___1SffY">"19v60r"</span>,
               <span class="highlight__hljs-string___1SffY">"secure_media_embed"</span>:{

               },
               <span class="highlight__hljs-string___1SffY">"clicked"</span>:<span class="highlight__hljs-literal___1V6TY">false</span>,
               <span class="highlight__hljs-string___1SffY">"stickied"</span>:<span class="highlight__hljs-literal___1V6TY">false</span>,
               <span class="highlight__hljs-string___1SffY">"author"</span>:<span class="highlight__hljs-string___1SffY">"BonzoESC"</span>,
               <span class="highlight__hljs-string___1SffY">"media"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"score"</span>:<span class="highlight__hljs-number___2gmaH">1</span>,
               <span class="highlight__hljs-string___1SffY">"approved_by"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"over_18"</span>:<span class="highlight__hljs-literal___1V6TY">false</span>,
               <span class="highlight__hljs-string___1SffY">"hidden"</span>:<span class="highlight__hljs-literal___1V6TY">false</span>,
               <span class="highlight__hljs-string___1SffY">"thumbnail"</span>:<span class="highlight__hljs-string___1SffY">""</span>,
               <span class="highlight__hljs-string___1SffY">"subreddit_id"</span>:<span class="highlight__hljs-string___1SffY">"t5_2s3vw"</span>,
               <span class="highlight__hljs-string___1SffY">"edited"</span>:<span class="highlight__hljs-literal___1V6TY">false</span>,
               <span class="highlight__hljs-string___1SffY">"link_flair_css_class"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"author_flair_css_class"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"downs"</span>:<span class="highlight__hljs-number___2gmaH">0</span>,
               <span class="highlight__hljs-string___1SffY">"saved"</span>:<span class="highlight__hljs-literal___1V6TY">false</span>,
               <span class="highlight__hljs-string___1SffY">"is_self"</span>:<span class="highlight__hljs-literal___1V6TY">false</span>,
               <span class="highlight__hljs-string___1SffY">"permalink"</span>:<span class="highlight__hljs-string___1SffY">"/r/Riak..riak/"</span>,
               <span class="highlight__hljs-string___1SffY">"name"</span>:<span class="highlight__hljs-string___1SffY">"t3_19v60r"</span>,
               <span class="highlight__hljs-string___1SffY">"created"</span>:<span class="highlight__hljs-number___2gmaH">1362687827.0</span>,
               <span class="highlight__hljs-string___1SffY">"url"</span>:<span class="highlight__hljs-string___1SffY">"https://github.com/basho/riak_dt"</span>,
               <span class="highlight__hljs-string___1SffY">"author_flair_text"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"title"</span>:<span class="highlight__hljs-string___1SffY">"riak_dt: CRDT for Riak"</span>,
               <span class="highlight__hljs-string___1SffY">"created_utc"</span>:<span class="highlight__hljs-number___2gmaH">1362687827.0</span>,
               <span class="highlight__hljs-string___1SffY">"ups"</span>:<span class="highlight__hljs-number___2gmaH">1</span>,
               <span class="highlight__hljs-string___1SffY">"num_comments"</span>:<span class="highlight__hljs-number___2gmaH">0</span>,
               <span class="highlight__hljs-string___1SffY">"visited"</span>:<span class="highlight__hljs-literal___1V6TY">false</span>,
               <span class="highlight__hljs-string___1SffY">"num_reports"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
               <span class="highlight__hljs-string___1SffY">"distinguished"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>
            }
         }
      ],
      <span class="highlight__hljs-string___1SffY">"after"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>,
      <span class="highlight__hljs-string___1SffY">"before"</span>:<span class="highlight__hljs-literal___1V6TY">null</span>
   }
}
</code></pre>
<p>We will create a few classes to model the data. The first being <code>Reddit.java</code>.</p>
<p>In <code>Reddit.java</code> we include the keys <code>kind</code> and <code>data</code> using <code>@Key</code>
declarations. Then we declare their types.</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code><span class="highlight__hljs-keyword___som98">package</span> com.christopherbiscardi.robospicetest;

<span class="highlight__hljs-keyword___som98">import</span> com.google.api.client.util.Key;

<span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-class___mOeOV"><span class="highlight__hljs-keyword___som98">class</span> <span class="highlight__hljs-title___1fl8Q">Reddit</span> </span>{
	<span class="hljs-meta">@Key</span>
	<span class="highlight__hljs-keyword___som98">private</span> String kind;
	<span class="hljs-meta">@Key</span>
	<span class="highlight__hljs-keyword___som98">private</span> RedditData data;

	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-title___1fl8Q">Reddit</span><span class="hljs-params">()</span> </span>{
	}
</code></pre>
<p>Then define some basic getters for when we are dealing with our request’s
response.</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code>  <span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> String <span class="highlight__hljs-title___1fl8Q">getKind</span><span class="hljs-params">()</span> </span>{
		<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-keyword___som98">this</span>.kind;
	}

	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> RedditData <span class="highlight__hljs-title___1fl8Q">getData</span><span class="hljs-params">()</span> </span>{
		<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-keyword___som98">this</span>.data;
	}
</code></pre>
<p>and override some utility functions:</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code>	<span class="hljs-meta">@Override</span>
	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-keyword___som98">int</span> <span class="highlight__hljs-title___1fl8Q">hashCode</span><span class="hljs-params">()</span> </span>{
		<span class="highlight__hljs-keyword___som98">final</span> <span class="highlight__hljs-keyword___som98">int</span> prime = <span class="highlight__hljs-number___2gmaH">31</span>;
		<span class="highlight__hljs-keyword___som98">int</span> result = <span class="highlight__hljs-number___2gmaH">1</span>;
		result = prime * result + ( kind == <span class="highlight__hljs-keyword___som98">null</span> ? <span class="highlight__hljs-number___2gmaH">0</span> : kind.hashCode() ) + ( data == <span class="highlight__hljs-keyword___som98">null</span> ? <span class="highlight__hljs-number___2gmaH">0</span> : data.hashCode() );
		<span class="highlight__hljs-keyword___som98">return</span> result;
	}

	<span class="hljs-meta">@Override</span>
	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-keyword___som98">boolean</span> <span class="highlight__hljs-title___1fl8Q">equals</span><span class="hljs-params">( Object obj )</span> </span>{
		<span class="highlight__hljs-keyword___som98">if</span> ( <span class="highlight__hljs-keyword___som98">this</span> == obj ) {
			<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-keyword___som98">true</span>;
		}
		<span class="highlight__hljs-keyword___som98">if</span> ( obj == <span class="highlight__hljs-keyword___som98">null</span> ) {
			<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-keyword___som98">false</span>;
		}
		<span class="highlight__hljs-keyword___som98">if</span> ( getClass() != obj.getClass() ) {
			<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-keyword___som98">false</span>;
		}
		Reddit other = (Reddit) obj;
		<span class="highlight__hljs-keyword___som98">if</span> ( kind == <span class="highlight__hljs-keyword___som98">null</span> ) {
			<span class="highlight__hljs-keyword___som98">if</span> ( other.kind != <span class="highlight__hljs-keyword___som98">null</span> ) {
				<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-keyword___som98">false</span>;
			}
		} <span class="highlight__hljs-keyword___som98">else</span> <span class="highlight__hljs-keyword___som98">if</span> ( !kind.equals( other.kind ) ) {
			<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-keyword___som98">false</span>;
		}
		<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-keyword___som98">true</span>;
	}

	<span class="hljs-meta">@Override</span>
	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> String <span class="highlight__hljs-title___1fl8Q">toString</span><span class="hljs-params">()</span> </span>{
		<span class="highlight__hljs-keyword___som98">return</span> <span class="highlight__hljs-string___1SffY">"Reddit [kind="</span> + kind + <span class="highlight__hljs-string___1SffY">" "</span> + data + <span class="highlight__hljs-string___1SffY">"]"</span>;
	}
}
</code></pre>
<p>The model files will all follow this same format: @Key definitions, getters,
utilities.</p>
<p>Our final model (<code>RedditListing.java</code>) is where we are getting the content we
care about. We don’t have to include <code>@Key</code> for every key in our JSON response,
so we’ll just grab the ones we care about:</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code>	<span class="hljs-meta">@Key</span>
	<span class="highlight__hljs-keyword___som98">private</span> String domain;
    <span class="hljs-meta">@Key</span>
	<span class="highlight__hljs-keyword___som98">private</span> String author;
    <span class="hljs-meta">@Key</span>
	<span class="highlight__hljs-keyword___som98">private</span> String permalink;
    <span class="hljs-meta">@Key</span>
	<span class="highlight__hljs-keyword___som98">private</span> String title;
</code></pre>
<h4 id="spicerequestredditjava">SpiceRequestReddit.java</h4>
<p>To finish off our classes, we’ll create a SpiceRequest that takes a string (our
subreddit) and returns a <code>Reddit</code>.</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code><span class="highlight__hljs-keyword___som98">package</span> com.christopherbiscardi.robospicetest;

<span class="highlight__hljs-keyword___som98">import</span> java.io.IOException;

<span class="highlight__hljs-keyword___som98">import</span> roboguice.util.temp.Ln;

<span class="highlight__hljs-keyword___som98">import</span> com.google.api.client.http.GenericUrl;
<span class="highlight__hljs-keyword___som98">import</span> com.google.api.client.http.HttpRequest;
<span class="highlight__hljs-keyword___som98">import</span> com.google.api.client.json.jackson.JacksonFactory;
<span class="highlight__hljs-keyword___som98">import</span> com.octo.android.robospice.request.googlehttpclient.GoogleHttpClientSpiceRequest;

<span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-class___mOeOV"><span class="highlight__hljs-keyword___som98">class</span> <span class="highlight__hljs-title___1fl8Q">SpiceRequestReddit</span> <span class="highlight__hljs-keyword___som98">extends</span> <span class="highlight__hljs-title___1fl8Q">GoogleHttpClientSpiceRequest</span>&lt;<span class="highlight__hljs-title___1fl8Q">reddit</span>&gt; </span>{
	<span class="highlight__hljs-keyword___som98">private</span> String baseUrl;

    <span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-title___1fl8Q">SpiceRequestReddit</span><span class="hljs-params">( String subreddit )</span> </span>{
        <span class="highlight__hljs-keyword___som98">super</span>( Reddit.class );
        <span class="highlight__hljs-keyword___som98">this</span>.baseUrl = String.format( <span class="highlight__hljs-string___1SffY">"http://www.reddit.com/r/%s.json"</span>, subreddit );
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> Reddit <span class="highlight__hljs-title___1fl8Q">loadDataFromNetwork</span><span class="hljs-params">()</span> <span class="highlight__hljs-keyword___som98">throws</span> IOException </span>{
        Ln.d( <span class="highlight__hljs-string___1SffY">"Call web service "</span> + baseUrl );
        HttpRequest request = getHttpRequestFactory()<span class="highlight__hljs-comment___UYk12">//</span>
                .buildGetRequest( <span class="highlight__hljs-keyword___som98">new</span> GenericUrl( baseUrl ) );
        request.setParser( <span class="highlight__hljs-keyword___som98">new</span> JacksonFactory().createJsonObjectParser() );
        <span class="highlight__hljs-keyword___som98">return</span> request.execute().parseAs( getResultType() );
    }
}&lt;/reddit&gt;
</code></pre>
<h2 id="calling-the-api">Calling the API</h2>
<p>In <code>MainActivity.java</code> we need to add some code to execute the request:</p>
<p>We need to extend our <code>MainActivity</code> from <code>BaseSpiceActivity</code></p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code><span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-class___mOeOV"><span class="highlight__hljs-keyword___som98">class</span> <span class="highlight__hljs-title___1fl8Q">MainActivity</span> <span class="highlight__hljs-keyword___som98">extends</span> <span class="highlight__hljs-title___1fl8Q">BaseSpiceActivity</span> </span>{
</code></pre>
<p>Add a new <code>SpiceRequestReddit</code></p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code>java
private SpiceRequestReddit spiceRequestReddit;
</code></pre>
<p>Instantiate it with the Riak subreddit;</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code>spiceRequestReddit = <span class="highlight__hljs-keyword___som98">new</span> SpiceRequestReddit( <span class="highlight__hljs-string___1SffY">"Riak"</span> );
</code></pre>
<p>and implement our ResultHandler class:</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code><span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-keyword___som98">final</span> <span class="highlight__hljs-class___mOeOV"><span class="highlight__hljs-keyword___som98">class</span> <span class="highlight__hljs-title___1fl8Q">RedditSpiceRequestListener</span> <span class="highlight__hljs-keyword___som98">implements</span> <span class="highlight__hljs-title___1fl8Q">RequestListener</span> </span>{

		<span class="hljs-meta">@Override</span>
		<span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-keyword___som98">void</span> <span class="highlight__hljs-title___1fl8Q">onRequestFailure</span><span class="hljs-params">( SpiceException spiceException )</span> </span>{
			Toast.makeText( MainActivity.<span class="highlight__hljs-keyword___som98">this</span>, <span class="highlight__hljs-string___1SffY">"failure"</span>, Toast.LENGTH_SHORT ).show();
		}

		<span class="hljs-meta">@Override</span>
		<span class="hljs-function"><span class="highlight__hljs-keyword___som98">public</span> <span class="highlight__hljs-keyword___som98">void</span> <span class="highlight__hljs-title___1fl8Q">onRequestSuccess</span><span class="hljs-params">( <span class="highlight__hljs-keyword___som98">final</span> Reddit result )</span> </span>{
			Toast.makeText( MainActivity.<span class="highlight__hljs-keyword___som98">this</span>, <span class="highlight__hljs-string___1SffY">"success"</span>, Toast.LENGTH_SHORT ).show();
			Log.e(<span class="highlight__hljs-string___1SffY">"TEST"</span>,result.getData().toString());
			Log.e(<span class="highlight__hljs-string___1SffY">"TEST"</span>,result.getData().getChildren().get(<span class="highlight__hljs-number___2gmaH">0</span>).getData().getTitle());
		}
	}
</code></pre>
<p>We’ve just implemented a simple log to view the data, but we could have added it
to an ArrayAdapter and displayed it in a ListView.</p>
<p>Finally, we override the <code>onStart()</code> method to actually make the request.</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code>  <span class="hljs-meta">@Override</span>
	<span class="hljs-function"><span class="highlight__hljs-keyword___som98">protected</span> <span class="highlight__hljs-keyword___som98">void</span> <span class="highlight__hljs-title___1fl8Q">onStart</span><span class="hljs-params">()</span> </span>{
		<span class="highlight__hljs-keyword___som98">super</span>.onStart();

		setProgressBarIndeterminate( <span class="highlight__hljs-keyword___som98">false</span> );
		setProgressBarVisibility( <span class="highlight__hljs-keyword___som98">true</span> );

		getSpiceManager().execute( spiceRequestReddit, <span class="highlight__hljs-string___1SffY">"json"</span>, DurationInMillis.ONE_MINUTE, <span class="highlight__hljs-keyword___som98">new</span> RedditSpiceRequestListener() );
	}
</code></pre>
<h2 id="androidmanifestxml">AndroidManifest.xml</h2>
<p>Now that’s all the code we need to write, but we still need to register our
service and permissions in <code>AndroidManifest.xml</code>. Notice we’ve added three
<code>uses-permission</code> nodes and a <code>service</code> node.</p>
<pre class="highlight__hljs___FzKxy index__p2___65FBl"><code><span class="php"><span class="hljs-meta">&lt;?</span>xml version=<span class="highlight__hljs-string___1SffY">"1.0"</span> encoding=<span class="highlight__hljs-string___1SffY">"utf-8"</span><span class="hljs-meta">?&gt;</span></span>
<span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="highlight__hljs-string___1SffY">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">package</span>=<span class="highlight__hljs-string___1SffY">"com.christopherbiscardi.robospicetest"</span>
    <span class="hljs-attr">android:versionCode</span>=<span class="highlight__hljs-string___1SffY">"1"</span>
    <span class="hljs-attr">android:versionName</span>=<span class="highlight__hljs-string___1SffY">"1.0"</span> &gt;</span>

    <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">uses-sdk</span>
        <span class="hljs-attr">android:minSdkVersion</span>=<span class="highlight__hljs-string___1SffY">"8"</span>
        <span class="hljs-attr">android:targetSdkVersion</span>=<span class="highlight__hljs-string___1SffY">"17"</span> /&gt;</span>

    <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="highlight__hljs-string___1SffY">"android.permission.INTERNET"</span> /&gt;</span>
    <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="highlight__hljs-string___1SffY">"android.permission.ACCESS_NETWORK_STATE"</span> /&gt;</span>
    <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="highlight__hljs-string___1SffY">"android.permission.ACCESS_WIFI_STATE"</span> /&gt;</span>

    <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">application</span>
        <span class="hljs-attr">android:allowBackup</span>=<span class="highlight__hljs-string___1SffY">"true"</span>
        <span class="hljs-attr">android:icon</span>=<span class="highlight__hljs-string___1SffY">"@drawable/ic_launcher"</span>
        <span class="hljs-attr">android:label</span>=<span class="highlight__hljs-string___1SffY">"@string/app_name"</span>
        <span class="hljs-attr">android:theme</span>=<span class="highlight__hljs-string___1SffY">"@style/AppTheme"</span> &gt;</span>
        <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">activity</span>
            <span class="hljs-attr">android:name</span>=<span class="highlight__hljs-string___1SffY">"com.christopherbiscardi.robospicetest.MainActivity"</span>
            <span class="hljs-attr">android:label</span>=<span class="highlight__hljs-string___1SffY">"@string/app_name"</span> &gt;</span>
            <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
                <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="highlight__hljs-string___1SffY">"android.intent.action.MAIN"</span> /&gt;</span>

                <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="highlight__hljs-string___1SffY">"android.intent.category.LAUNCHER"</span> /&gt;</span>
            <span class="highlight__hljs-tag___2Bb-l">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
        <span class="highlight__hljs-tag___2Bb-l">&lt;/<span class="hljs-name">activity</span>&gt;</span>

        <span class="highlight__hljs-tag___2Bb-l">&lt;<span class="hljs-name">service</span>
            <span class="hljs-attr">android:name</span>=<span class="highlight__hljs-string___1SffY">"com.octo.android.robospice.JacksonGoogleHttpClientSpiceService"</span>
            <span class="hljs-attr">android:exported</span>=<span class="highlight__hljs-string___1SffY">"false"</span> /&gt;</span>
    <span class="highlight__hljs-tag___2Bb-l">&lt;/<span class="hljs-name">application</span>&gt;</span>

<span class="highlight__hljs-tag___2Bb-l">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
</code></pre>
<h2 id="fin">Fin</h2>
<p>Now we can run the app and see the result (success or failure) pop up as a Toast
as well as viewing the actual data in LogCat.</p>
<p>Check out the github repository
<a href="https://github.com/ChristopherBiscardi/robospice-googlehttpclient-example">here</a></p>
</div></div></div></div></div></div></div><script charset="UTF-8">window.__APOLLO_STATE__={"apollo":{"data":{"$ROOT_QUERY.root.post({\"slug\":\"android-robospice-with-googlehttpclient\"})":{"body":"<p>In this post we will examine an example app in which we make a RoboSpice request\nusing GoogleHttpClient.</p>\n<p>The github repo is\n<a href=\"https://github.com/ChristopherBiscardi/robospice-googlehttpclient-example\">here</a>.</p>\n<h2 id=\"dependencies\">Dependencies</h2>\n<p>First, we need to grab the RoboSpice dependency JARs from the <code>repository</code> repo.</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code>git <span class=\"highlight__hljs-built_in___3uuyR\">clone</span> https://github.com/octo-online/robospice/tree/repository\n</code></pre>\n<p>Inside of\n<a href=\"https://github.com/octo-online/robospice/tree/repository/dependencies/1.4.11/robospice-google-http-client\">1.4.11/robospice-google-http-client</a>\nare the JARs we need to include in the project. If you are using Eclipse copy\nthe JARs into your <code>libs/</code> folder and add them to the build path in <code>Project -&gt; Properties -&gt; Libraries</code> by clicking <code>Add JARs</code>. You may also need to click the\n<code>Order and Export</code> tab, check their boxes and move the included JARs to the top.</p>\n<p>We will also need one JAR from the Google-Http-Lib\n<a href=\"https://code.google.com/p/google-http-java-client/wiki/Setup#Download_Library_with_Dependencies\">source</a>.\nIt is <code>google-http-client-1.17.0</code>. Again, if using Eclipse, add it to your\nproject in the same way.</p>\n<h2 id=\"classes\">Classes</h2>\n<p>We are going to create a few files:</p>\n<ul>\n<li><a href=\"#spice-base\">BaseSpiceActivity.java</a></li>\n<li><a href=\"#spice-reddit\">Reddit*.java</a></li>\n<li><a href=\"#spice-request-reddit\">SpiceRequestReddit.java</a></li>\n</ul>\n<h4 id=\"basespiceactivity\">BaseSpiceActivity</h4>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code><span class=\"highlight__hljs-keyword___som98\">import</span> com.octo.android.robospice.JacksonGoogleHttpClientSpiceService;\n<span class=\"highlight__hljs-keyword___som98\">import</span> com.octo.android.robospice.SpiceManager;\n\n<span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-class___mOeOV\"><span class=\"highlight__hljs-keyword___som98\">class</span> <span class=\"highlight__hljs-title___1fl8Q\">BaseSpiceActivity</span> <span class=\"highlight__hljs-keyword___som98\">extends</span> <span class=\"highlight__hljs-title___1fl8Q\">Activity</span> </span>{\n\t<span class=\"highlight__hljs-keyword___som98\">private</span> SpiceManager spiceManager = <span class=\"highlight__hljs-keyword___som98\">new</span> SpiceManager(JacksonGoogleHttpClientSpiceService.class);\n\n\t<span class=\"hljs-meta\">@Override</span>\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">protected</span> <span class=\"highlight__hljs-keyword___som98\">void</span> <span class=\"highlight__hljs-title___1fl8Q\">onStart</span><span class=\"hljs-params\">()</span> </span>{\n\t\tspiceManager.start(<span class=\"highlight__hljs-keyword___som98\">this</span>);\n\t\t<span class=\"highlight__hljs-keyword___som98\">super</span>.onStart();\n\t}\n\n\t<span class=\"hljs-meta\">@Override</span>\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">protected</span> <span class=\"highlight__hljs-keyword___som98\">void</span> <span class=\"highlight__hljs-title___1fl8Q\">onStop</span><span class=\"hljs-params\">()</span> </span>{\n\t\tspiceManager.shouldStop();\n\t\t<span class=\"highlight__hljs-keyword___som98\">super</span>.onStop();\n\t}\n\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">protected</span> SpiceManager <span class=\"highlight__hljs-title___1fl8Q\">getSpiceManager</span><span class=\"hljs-params\">()</span> </span>{\n\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> spiceManager;\n\t}\n\n}\n</code></pre>\n<p>The big thing we’re doing in this file is creating an instance of <code>SpiceManager</code>\nthat will be accessible in the activities that inherit from this base class\n(like our <code>MainActivity.java</code> will).</p>\n<p>We then start <code>spiceManager</code> in <code>onStart()</code> and stop it in <code>onStop</code>. This will\nensure that our activities have a <code>SpiceManager</code> accessible when they start and\nclean up after themselves when they stop.</p>\n<p>The final piece is a getter function (<code>getSpiceManager()</code>) so that we have easy\naccess to the <code>spiceManager</code> in our activities.</p>\n<h4 id=\"redditjava\">Reddit*.java</h4>\n<p>We will be getting our data from Reddit, so we first need to examine the\nresponses we’re going to get. I’ve chosen a subreddit where all the posts are\nvery similar (/r/Riak). Here is a sample API response:</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code>{\n   <span class=\"highlight__hljs-string___1SffY\">\"kind\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"Listing\"</span>,\n   <span class=\"highlight__hljs-string___1SffY\">\"data\"</span>:{\n      <span class=\"highlight__hljs-string___1SffY\">\"modhash\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"3mxugaulcd1f8b500be09\"</span>,\n      <span class=\"highlight__hljs-string___1SffY\">\"children\"</span>:[\n         {\n            <span class=\"highlight__hljs-string___1SffY\">\"kind\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"t3\"</span>,\n            <span class=\"highlight__hljs-string___1SffY\">\"data\"</span>:{\n               <span class=\"highlight__hljs-string___1SffY\">\"domain\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"github.com\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"banned_by\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"media_embed\"</span>:{\n\n               },\n               <span class=\"highlight__hljs-string___1SffY\">\"subreddit\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"Riak\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"selftext_html\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"selftext\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"likes\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"secure_media\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"link_flair_text\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"id\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"19v60r\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"secure_media_embed\"</span>:{\n\n               },\n               <span class=\"highlight__hljs-string___1SffY\">\"clicked\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">false</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"stickied\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">false</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"author\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"BonzoESC\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"media\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"score\"</span>:<span class=\"highlight__hljs-number___2gmaH\">1</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"approved_by\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"over_18\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">false</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"hidden\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">false</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"thumbnail\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"subreddit_id\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"t5_2s3vw\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"edited\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">false</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"link_flair_css_class\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"author_flair_css_class\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"downs\"</span>:<span class=\"highlight__hljs-number___2gmaH\">0</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"saved\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">false</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"is_self\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">false</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"permalink\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"/r/Riak..riak/\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"name\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"t3_19v60r\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"created\"</span>:<span class=\"highlight__hljs-number___2gmaH\">1362687827.0</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"url\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"https://github.com/basho/riak_dt\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"author_flair_text\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"title\"</span>:<span class=\"highlight__hljs-string___1SffY\">\"riak_dt: CRDT for Riak\"</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"created_utc\"</span>:<span class=\"highlight__hljs-number___2gmaH\">1362687827.0</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"ups\"</span>:<span class=\"highlight__hljs-number___2gmaH\">1</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"num_comments\"</span>:<span class=\"highlight__hljs-number___2gmaH\">0</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"visited\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">false</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"num_reports\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n               <span class=\"highlight__hljs-string___1SffY\">\"distinguished\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>\n            }\n         }\n      ],\n      <span class=\"highlight__hljs-string___1SffY\">\"after\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>,\n      <span class=\"highlight__hljs-string___1SffY\">\"before\"</span>:<span class=\"highlight__hljs-literal___1V6TY\">null</span>\n   }\n}\n</code></pre>\n<p>We will create a few classes to model the data. The first being <code>Reddit.java</code>.</p>\n<p>In <code>Reddit.java</code> we include the keys <code>kind</code> and <code>data</code> using <code>@Key</code>\ndeclarations. Then we declare their types.</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code><span class=\"highlight__hljs-keyword___som98\">package</span> com.christopherbiscardi.robospicetest;\n\n<span class=\"highlight__hljs-keyword___som98\">import</span> com.google.api.client.util.Key;\n\n<span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-class___mOeOV\"><span class=\"highlight__hljs-keyword___som98\">class</span> <span class=\"highlight__hljs-title___1fl8Q\">Reddit</span> </span>{\n\t<span class=\"hljs-meta\">@Key</span>\n\t<span class=\"highlight__hljs-keyword___som98\">private</span> String kind;\n\t<span class=\"hljs-meta\">@Key</span>\n\t<span class=\"highlight__hljs-keyword___som98\">private</span> RedditData data;\n\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-title___1fl8Q\">Reddit</span><span class=\"hljs-params\">()</span> </span>{\n\t}\n</code></pre>\n<p>Then define some basic getters for when we are dealing with our request’s\nresponse.</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code>  <span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> String <span class=\"highlight__hljs-title___1fl8Q\">getKind</span><span class=\"hljs-params\">()</span> </span>{\n\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-keyword___som98\">this</span>.kind;\n\t}\n\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> RedditData <span class=\"highlight__hljs-title___1fl8Q\">getData</span><span class=\"hljs-params\">()</span> </span>{\n\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-keyword___som98\">this</span>.data;\n\t}\n</code></pre>\n<p>and override some utility functions:</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code>\t<span class=\"hljs-meta\">@Override</span>\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-keyword___som98\">int</span> <span class=\"highlight__hljs-title___1fl8Q\">hashCode</span><span class=\"hljs-params\">()</span> </span>{\n\t\t<span class=\"highlight__hljs-keyword___som98\">final</span> <span class=\"highlight__hljs-keyword___som98\">int</span> prime = <span class=\"highlight__hljs-number___2gmaH\">31</span>;\n\t\t<span class=\"highlight__hljs-keyword___som98\">int</span> result = <span class=\"highlight__hljs-number___2gmaH\">1</span>;\n\t\tresult = prime * result + ( kind == <span class=\"highlight__hljs-keyword___som98\">null</span> ? <span class=\"highlight__hljs-number___2gmaH\">0</span> : kind.hashCode() ) + ( data == <span class=\"highlight__hljs-keyword___som98\">null</span> ? <span class=\"highlight__hljs-number___2gmaH\">0</span> : data.hashCode() );\n\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> result;\n\t}\n\n\t<span class=\"hljs-meta\">@Override</span>\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-keyword___som98\">boolean</span> <span class=\"highlight__hljs-title___1fl8Q\">equals</span><span class=\"hljs-params\">( Object obj )</span> </span>{\n\t\t<span class=\"highlight__hljs-keyword___som98\">if</span> ( <span class=\"highlight__hljs-keyword___som98\">this</span> == obj ) {\n\t\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-keyword___som98\">true</span>;\n\t\t}\n\t\t<span class=\"highlight__hljs-keyword___som98\">if</span> ( obj == <span class=\"highlight__hljs-keyword___som98\">null</span> ) {\n\t\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-keyword___som98\">false</span>;\n\t\t}\n\t\t<span class=\"highlight__hljs-keyword___som98\">if</span> ( getClass() != obj.getClass() ) {\n\t\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-keyword___som98\">false</span>;\n\t\t}\n\t\tReddit other = (Reddit) obj;\n\t\t<span class=\"highlight__hljs-keyword___som98\">if</span> ( kind == <span class=\"highlight__hljs-keyword___som98\">null</span> ) {\n\t\t\t<span class=\"highlight__hljs-keyword___som98\">if</span> ( other.kind != <span class=\"highlight__hljs-keyword___som98\">null</span> ) {\n\t\t\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-keyword___som98\">false</span>;\n\t\t\t}\n\t\t} <span class=\"highlight__hljs-keyword___som98\">else</span> <span class=\"highlight__hljs-keyword___som98\">if</span> ( !kind.equals( other.kind ) ) {\n\t\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-keyword___som98\">false</span>;\n\t\t}\n\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-keyword___som98\">true</span>;\n\t}\n\n\t<span class=\"hljs-meta\">@Override</span>\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> String <span class=\"highlight__hljs-title___1fl8Q\">toString</span><span class=\"hljs-params\">()</span> </span>{\n\t\t<span class=\"highlight__hljs-keyword___som98\">return</span> <span class=\"highlight__hljs-string___1SffY\">\"Reddit [kind=\"</span> + kind + <span class=\"highlight__hljs-string___1SffY\">\" \"</span> + data + <span class=\"highlight__hljs-string___1SffY\">\"]\"</span>;\n\t}\n}\n</code></pre>\n<p>The model files will all follow this same format: @Key definitions, getters,\nutilities.</p>\n<p>Our final model (<code>RedditListing.java</code>) is where we are getting the content we\ncare about. We don’t have to include <code>@Key</code> for every key in our JSON response,\nso we’ll just grab the ones we care about:</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code>\t<span class=\"hljs-meta\">@Key</span>\n\t<span class=\"highlight__hljs-keyword___som98\">private</span> String domain;\n    <span class=\"hljs-meta\">@Key</span>\n\t<span class=\"highlight__hljs-keyword___som98\">private</span> String author;\n    <span class=\"hljs-meta\">@Key</span>\n\t<span class=\"highlight__hljs-keyword___som98\">private</span> String permalink;\n    <span class=\"hljs-meta\">@Key</span>\n\t<span class=\"highlight__hljs-keyword___som98\">private</span> String title;\n</code></pre>\n<h4 id=\"spicerequestredditjava\">SpiceRequestReddit.java</h4>\n<p>To finish off our classes, we’ll create a SpiceRequest that takes a string (our\nsubreddit) and returns a <code>Reddit</code>.</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code><span class=\"highlight__hljs-keyword___som98\">package</span> com.christopherbiscardi.robospicetest;\n\n<span class=\"highlight__hljs-keyword___som98\">import</span> java.io.IOException;\n\n<span class=\"highlight__hljs-keyword___som98\">import</span> roboguice.util.temp.Ln;\n\n<span class=\"highlight__hljs-keyword___som98\">import</span> com.google.api.client.http.GenericUrl;\n<span class=\"highlight__hljs-keyword___som98\">import</span> com.google.api.client.http.HttpRequest;\n<span class=\"highlight__hljs-keyword___som98\">import</span> com.google.api.client.json.jackson.JacksonFactory;\n<span class=\"highlight__hljs-keyword___som98\">import</span> com.octo.android.robospice.request.googlehttpclient.GoogleHttpClientSpiceRequest;\n\n<span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-class___mOeOV\"><span class=\"highlight__hljs-keyword___som98\">class</span> <span class=\"highlight__hljs-title___1fl8Q\">SpiceRequestReddit</span> <span class=\"highlight__hljs-keyword___som98\">extends</span> <span class=\"highlight__hljs-title___1fl8Q\">GoogleHttpClientSpiceRequest</span>&lt;<span class=\"highlight__hljs-title___1fl8Q\">reddit</span>&gt; </span>{\n\t<span class=\"highlight__hljs-keyword___som98\">private</span> String baseUrl;\n\n    <span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-title___1fl8Q\">SpiceRequestReddit</span><span class=\"hljs-params\">( String subreddit )</span> </span>{\n        <span class=\"highlight__hljs-keyword___som98\">super</span>( Reddit.class );\n        <span class=\"highlight__hljs-keyword___som98\">this</span>.baseUrl = String.format( <span class=\"highlight__hljs-string___1SffY\">\"http://www.reddit.com/r/%s.json\"</span>, subreddit );\n    }\n\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> Reddit <span class=\"highlight__hljs-title___1fl8Q\">loadDataFromNetwork</span><span class=\"hljs-params\">()</span> <span class=\"highlight__hljs-keyword___som98\">throws</span> IOException </span>{\n        Ln.d( <span class=\"highlight__hljs-string___1SffY\">\"Call web service \"</span> + baseUrl );\n        HttpRequest request = getHttpRequestFactory()<span class=\"highlight__hljs-comment___UYk12\">//</span>\n                .buildGetRequest( <span class=\"highlight__hljs-keyword___som98\">new</span> GenericUrl( baseUrl ) );\n        request.setParser( <span class=\"highlight__hljs-keyword___som98\">new</span> JacksonFactory().createJsonObjectParser() );\n        <span class=\"highlight__hljs-keyword___som98\">return</span> request.execute().parseAs( getResultType() );\n    }\n}&lt;/reddit&gt;\n</code></pre>\n<h2 id=\"calling-the-api\">Calling the API</h2>\n<p>In <code>MainActivity.java</code> we need to add some code to execute the request:</p>\n<p>We need to extend our <code>MainActivity</code> from <code>BaseSpiceActivity</code></p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code><span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-class___mOeOV\"><span class=\"highlight__hljs-keyword___som98\">class</span> <span class=\"highlight__hljs-title___1fl8Q\">MainActivity</span> <span class=\"highlight__hljs-keyword___som98\">extends</span> <span class=\"highlight__hljs-title___1fl8Q\">BaseSpiceActivity</span> </span>{\n</code></pre>\n<p>Add a new <code>SpiceRequestReddit</code></p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code>java\nprivate SpiceRequestReddit spiceRequestReddit;\n</code></pre>\n<p>Instantiate it with the Riak subreddit;</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code>spiceRequestReddit = <span class=\"highlight__hljs-keyword___som98\">new</span> SpiceRequestReddit( <span class=\"highlight__hljs-string___1SffY\">\"Riak\"</span> );\n</code></pre>\n<p>and implement our ResultHandler class:</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code><span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-keyword___som98\">final</span> <span class=\"highlight__hljs-class___mOeOV\"><span class=\"highlight__hljs-keyword___som98\">class</span> <span class=\"highlight__hljs-title___1fl8Q\">RedditSpiceRequestListener</span> <span class=\"highlight__hljs-keyword___som98\">implements</span> <span class=\"highlight__hljs-title___1fl8Q\">RequestListener</span> </span>{\n\n\t\t<span class=\"hljs-meta\">@Override</span>\n\t\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-keyword___som98\">void</span> <span class=\"highlight__hljs-title___1fl8Q\">onRequestFailure</span><span class=\"hljs-params\">( SpiceException spiceException )</span> </span>{\n\t\t\tToast.makeText( MainActivity.<span class=\"highlight__hljs-keyword___som98\">this</span>, <span class=\"highlight__hljs-string___1SffY\">\"failure\"</span>, Toast.LENGTH_SHORT ).show();\n\t\t}\n\n\t\t<span class=\"hljs-meta\">@Override</span>\n\t\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">public</span> <span class=\"highlight__hljs-keyword___som98\">void</span> <span class=\"highlight__hljs-title___1fl8Q\">onRequestSuccess</span><span class=\"hljs-params\">( <span class=\"highlight__hljs-keyword___som98\">final</span> Reddit result )</span> </span>{\n\t\t\tToast.makeText( MainActivity.<span class=\"highlight__hljs-keyword___som98\">this</span>, <span class=\"highlight__hljs-string___1SffY\">\"success\"</span>, Toast.LENGTH_SHORT ).show();\n\t\t\tLog.e(<span class=\"highlight__hljs-string___1SffY\">\"TEST\"</span>,result.getData().toString());\n\t\t\tLog.e(<span class=\"highlight__hljs-string___1SffY\">\"TEST\"</span>,result.getData().getChildren().get(<span class=\"highlight__hljs-number___2gmaH\">0</span>).getData().getTitle());\n\t\t}\n\t}\n</code></pre>\n<p>We’ve just implemented a simple log to view the data, but we could have added it\nto an ArrayAdapter and displayed it in a ListView.</p>\n<p>Finally, we override the <code>onStart()</code> method to actually make the request.</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code>  <span class=\"hljs-meta\">@Override</span>\n\t<span class=\"hljs-function\"><span class=\"highlight__hljs-keyword___som98\">protected</span> <span class=\"highlight__hljs-keyword___som98\">void</span> <span class=\"highlight__hljs-title___1fl8Q\">onStart</span><span class=\"hljs-params\">()</span> </span>{\n\t\t<span class=\"highlight__hljs-keyword___som98\">super</span>.onStart();\n\n\t\tsetProgressBarIndeterminate( <span class=\"highlight__hljs-keyword___som98\">false</span> );\n\t\tsetProgressBarVisibility( <span class=\"highlight__hljs-keyword___som98\">true</span> );\n\n\t\tgetSpiceManager().execute( spiceRequestReddit, <span class=\"highlight__hljs-string___1SffY\">\"json\"</span>, DurationInMillis.ONE_MINUTE, <span class=\"highlight__hljs-keyword___som98\">new</span> RedditSpiceRequestListener() );\n\t}\n</code></pre>\n<h2 id=\"androidmanifestxml\">AndroidManifest.xml</h2>\n<p>Now that’s all the code we need to write, but we still need to register our\nservice and permissions in <code>AndroidManifest.xml</code>. Notice we’ve added three\n<code>uses-permission</code> nodes and a <code>service</code> node.</p>\n<pre class=\"highlight__hljs___FzKxy index__p2___65FBl\"><code><span class=\"php\"><span class=\"hljs-meta\">&lt;?</span>xml version=<span class=\"highlight__hljs-string___1SffY\">\"1.0\"</span> encoding=<span class=\"highlight__hljs-string___1SffY\">\"utf-8\"</span><span class=\"hljs-meta\">?&gt;</span></span>\n<span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">manifest</span> <span class=\"hljs-attr\">xmlns:android</span>=<span class=\"highlight__hljs-string___1SffY\">\"http://schemas.android.com/apk/res/android\"</span>\n    <span class=\"hljs-attr\">package</span>=<span class=\"highlight__hljs-string___1SffY\">\"com.christopherbiscardi.robospicetest\"</span>\n    <span class=\"hljs-attr\">android:versionCode</span>=<span class=\"highlight__hljs-string___1SffY\">\"1\"</span>\n    <span class=\"hljs-attr\">android:versionName</span>=<span class=\"highlight__hljs-string___1SffY\">\"1.0\"</span> &gt;</span>\n\n    <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">uses-sdk</span>\n        <span class=\"hljs-attr\">android:minSdkVersion</span>=<span class=\"highlight__hljs-string___1SffY\">\"8\"</span>\n        <span class=\"hljs-attr\">android:targetSdkVersion</span>=<span class=\"highlight__hljs-string___1SffY\">\"17\"</span> /&gt;</span>\n\n    <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">uses-permission</span> <span class=\"hljs-attr\">android:name</span>=<span class=\"highlight__hljs-string___1SffY\">\"android.permission.INTERNET\"</span> /&gt;</span>\n    <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">uses-permission</span> <span class=\"hljs-attr\">android:name</span>=<span class=\"highlight__hljs-string___1SffY\">\"android.permission.ACCESS_NETWORK_STATE\"</span> /&gt;</span>\n    <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">uses-permission</span> <span class=\"hljs-attr\">android:name</span>=<span class=\"highlight__hljs-string___1SffY\">\"android.permission.ACCESS_WIFI_STATE\"</span> /&gt;</span>\n\n    <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">application</span>\n        <span class=\"hljs-attr\">android:allowBackup</span>=<span class=\"highlight__hljs-string___1SffY\">\"true\"</span>\n        <span class=\"hljs-attr\">android:icon</span>=<span class=\"highlight__hljs-string___1SffY\">\"@drawable/ic_launcher\"</span>\n        <span class=\"hljs-attr\">android:label</span>=<span class=\"highlight__hljs-string___1SffY\">\"@string/app_name\"</span>\n        <span class=\"hljs-attr\">android:theme</span>=<span class=\"highlight__hljs-string___1SffY\">\"@style/AppTheme\"</span> &gt;</span>\n        <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">activity</span>\n            <span class=\"hljs-attr\">android:name</span>=<span class=\"highlight__hljs-string___1SffY\">\"com.christopherbiscardi.robospicetest.MainActivity\"</span>\n            <span class=\"hljs-attr\">android:label</span>=<span class=\"highlight__hljs-string___1SffY\">\"@string/app_name\"</span> &gt;</span>\n            <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">intent-filter</span>&gt;</span>\n                <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">action</span> <span class=\"hljs-attr\">android:name</span>=<span class=\"highlight__hljs-string___1SffY\">\"android.intent.action.MAIN\"</span> /&gt;</span>\n\n                <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">category</span> <span class=\"hljs-attr\">android:name</span>=<span class=\"highlight__hljs-string___1SffY\">\"android.intent.category.LAUNCHER\"</span> /&gt;</span>\n            <span class=\"highlight__hljs-tag___2Bb-l\">&lt;/<span class=\"hljs-name\">intent-filter</span>&gt;</span>\n        <span class=\"highlight__hljs-tag___2Bb-l\">&lt;/<span class=\"hljs-name\">activity</span>&gt;</span>\n\n        <span class=\"highlight__hljs-tag___2Bb-l\">&lt;<span class=\"hljs-name\">service</span>\n            <span class=\"hljs-attr\">android:name</span>=<span class=\"highlight__hljs-string___1SffY\">\"com.octo.android.robospice.JacksonGoogleHttpClientSpiceService\"</span>\n            <span class=\"hljs-attr\">android:exported</span>=<span class=\"highlight__hljs-string___1SffY\">\"false\"</span> /&gt;</span>\n    <span class=\"highlight__hljs-tag___2Bb-l\">&lt;/<span class=\"hljs-name\">application</span>&gt;</span>\n\n<span class=\"highlight__hljs-tag___2Bb-l\">&lt;/<span class=\"hljs-name\">manifest</span>&gt;</span>\n</code></pre>\n<h2 id=\"fin\">Fin</h2>\n<p>Now we can run the app and see the result (success or failure) pop up as a Toast\nas well as viewing the actual data in LogCat.</p>\n<p>Check out the github repository\n<a href=\"https://github.com/ChristopherBiscardi/robospice-googlehttpclient-example\">here</a></p>\n","attributes":{"type":"id","id":"$ROOT_QUERY.root.post({\"slug\":\"android-robospice-with-googlehttpclient\"}).attributes","generated":true},"__typename":"BlogPost"},"$ROOT_QUERY.root.post({\"slug\":\"android-robospice-with-googlehttpclient\"}).attributes":{"title":"Android RoboSpice with GoogleHttpClient","updatedAt":"Jan 27th, 2014","publishedAt":"Jan 27th, 2014","timeToRead":7,"headerImage":null,"url":"/2014/1/27/android-robospice-with-googlehttpclient/","canonicalURL":null,"excerpt":"In this post we will examine an example app in which we make a RoboSpice request\nusing GoogleHttpClient.","__typename":"BlogPostAttributes"},"$ROOT_QUERY.root":{"post({\"slug\":\"android-robospice-with-googlehttpclient\"})":{"type":"id","id":"$ROOT_QUERY.root.post({\"slug\":\"android-robospice-with-googlehttpclient\"})","generated":true},"__typename":"Query"},"ROOT_QUERY":{"root":{"type":"id","id":"$ROOT_QUERY.root","generated":true}}}}};</script><script src="/js/client.js" charset="UTF-8"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-46878058-1', 'auto');
          ga('send', 'pageview');</script></body></html>